---
server:
  http_listen_port: 9080
  grpc_listen_port: 0

positions:
  filename: /tmp/positions.yaml

clients:
  - url: http://gateway:3100/loki/api/v1/push
    tenant_id: tenant1
    backoff_config:
      max_period: 5m
      max_retries: 10
      min_period: 500ms
    batchsize: 1048576
    batchwait: 1s
    external_labels: {}
    timeout: 10s
target_config:
  sync_period: 10s


# scrape_configs:
#   - job_name: flog_scrape 
#     docker_sd_configs:
#       - host: unix:///var/run/docker.sock
#         refresh_interval: 5s
#     relabel_configs:
#       - source_labels: ['__meta_docker_container_name']
#         regex: '/(.*)'
#         target_label: 'container'


scrape_configs:
- job_name: system
  static_configs:
  - targets:
      - localhost
    labels:
      job: varlogs
      __path__: /var/log/*log
#   pipeline_stages:
#   - regex:
#       # extracts only sync pair and JobId from the log line
#       expression: '.*sync pair :(?P<syncpair>[a-zA-Z0-9_-]{30,36}).*JobId :(?P<jobid>[a-zA-Z0-9_-]{30,36})'
#   - labels:
#       # sources extracted syncpair as label 'sync pair' value and jobid as label 'JobId'
#       syncpair:
#       jobid:
# - job_name: containers
#   static_configs:
#   - targets:
#       - localhost
#     labels:
#       job: containers
#       __path__: /var/lib/docker/containers/*/*log
# - job_name: dockerlogs
#   file_sd_configs:
#   - files:
#     - /etc/promtail/promtail-targets.yml
#   relabel_configs:
#   - source_labels: [job]
#     target_label: job
#   - source_labels: [__address__]
#     target_label: container_id
#   - source_labels: [container_id]
#     target_label: __path__
#     replacement: /var/lib/docker/containers/*/*log

